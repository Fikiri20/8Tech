{% extends 'main.html' %}
{% load static %}
{% block content %}
  <div class="course">
    <div class="acad">
      <nav class="butto">
        <!-- Navigation bar with buttons to show different sections -->
        {% for section in sections %}
          <button onclick="showSection('{{ section.id }}')">{{ section.name }}</button>
        {% endfor %}
      </nav>

      {% for section in sections %}
        <div id="{{ section.id }}" class="section {% if section.id == 'homepage' %}active{% endif %}">
          <h2>{{ section.name }} - {{ course.course_name }}</h2>

          <!-- Content for each section -->
          <div class="sem2">
            <h3>1st Sem Notes and Past Papers</h3>
            <div class="btn">
              <button class="toggle-past-btn"><a href="#"><span></span>Exams</a></button>
              <button class="toggle-notes-btn"><a href="#"><span></span>Notes</a></button>
            </div>

            <div class="files-dropdown-past">
              {% for paper in past_papers %}
                {% if paper.year == section.year and paper.sem == 1 %}
                  <div>{{ paper.name }}</div>
                  <a href="{% url 'download_pastpaper' file_id=paper.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>

            <div class="files-dropdown-notes">
              {% for note in notes %}
                {% if note.year == section.year and note.sem == 1 %}
                  <div>{{ note.name }}</div>
                  <a href="{% url 'download_note' file_id=note.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>
          </div>

          <!-- Similar content for the 2nd semester -->
          <div class="sem2">
            <h3>2nd Sem Notes and Past Papers</h3>
            <div class="btn">
              <button class="toggle-past-btn"><a href="#"><span></span>Exams</a></button>
              <button class="toggle-notes-btn"><a href="#"><span></span>Notes</a></button>
            </div>

            <div class="files-dropdown-past">
              {% for paper in past_papers %}
                {% if paper.year == section.year and paper.sem == 2 %}
                  <div>{{ paper.name }}</div>
                  <a href="{% url 'download_pastpaper' file_id=paper.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>

            <div class="files-dropdown-notes">
              {% for note in notes %}
                {% if note.year == section.year and note.sem == 2 %}
                  <div>{{ note.name }}</div>
                  <a href="{% url 'download_note' file_id=note.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <div class="course-description">
      <h2>COURSE DESCRIPTION</h2>
      <h2>{{ course.course_name }}</h2>
      <p>{{ course.decription|linebreaksbr }}</p>
    </div>
  </div>

  <script>
    function showSection(sectionId) {
      var sections = document.querySelectorAll('.section');
      sections.forEach(function (section) {
        section.classList.remove('active');
        section.style.display = 'none';
      });

      var sectionToShow = document.getElementById(sectionId);
      if (sectionToShow) {
        sectionToShow.classList.add('active');
        sectionToShow.style.display = 'block';
      }

      window.scrollTo(0, 0);
    }

    showSection('homepage');

    function toggleSection(event, sectionClass) {
      event.preventDefault();

      const parentContainer = event.target.closest('.sem2');
      const pastSection = parentContainer.querySelector(".files-dropdown-past");
      const notesSection = parentContainer.querySelector(".files-dropdown-notes");

      if (sectionClass === 'past') {
        toggleDropdown(pastSection, notesSection);
      } else if (sectionClass === 'notes') {
        toggleDropdown(notesSection, pastSection);
      }
    }

    function toggleDropdown(showSection, hideSection) {
      if (showSection.classList.contains('show')) {
        showSection.classList.remove('show');
        showSection.style.maxHeight = '0'; // Collapse it by setting maxHeight to 0
        showSection.style.padding = '0'; // Collapse padding
      } else {
        showSection.classList.add('show');
        showSection.style.maxHeight = 'max-content';
        showSection.style.padding = '1rem'; // Add padding when expanded
    
        // Hide the other section
        hideSection.classList.remove('show');
        hideSection.style.maxHeight = '0'; // Ensure the other section is collapsed
        hideSection.style.padding = '0'; // Collapse padding of the hidden section
      }
    }
    
    

    document.querySelectorAll('.toggle-past-btn').forEach(button => {
      button.addEventListener('click', (event) => toggleSection(event, 'past'));
    });

    document.querySelectorAll('.toggle-notes-btn').forEach(button => {
      button.addEventListener('click', (event) => toggleSection(event, 'notes'));
    });
  </script>
{% endblock %}
