{% extends 'main.html' %}
{% load static %}
{% block content %}
  <div class="course">
    <div class="acad">
      <nav class="butto">
        <!-- Navigation bar with buttons to show different sections -->
        {% for section in sections %}
          <button onclick="showSection('{{ section.id }}')">{{ section.name }}</button>
        {% endfor %}
      </nav>

      {% for section in sections %}
        <div id="{{ section.id }}" class="section {% if section.id == 'homepage' %}active{% endif %}">
          <h2>{{ section.name }} - {{ course.course_name }}</h2>

          <!-- Content for each section -->
          <div class="sem2">
            <h3>1st Sem Notes and Past Papers</h3>
            <div class="btn">
              <button onclick="showNotesOrPastPapers(event)"><a href="#"><span></span>Exams</a></button>
              <button onclick="showNotesOrPastPapers(event)"><a href="#"><span></span>Notes</a></button>
            </div>

            <div class="files-dropdown-past">
              {% for paper in past_papers %}
                {% if paper.year == section.year and paper.sem == 1 %}
                  <div>{{ paper.name }}</div>
                  <a href="{% url 'download_pastpaper' file_id=paper.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>

            <div class="files-dropdown-notes">
              {% for note in notes %}
                {% if note.year == section.year and note.sem == 1 %}
                  <div>{{ note.name }}</div>
                  <a href="{% url 'download_note' file_id=note.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>
          </div>

          <!-- Similar content for the 2nd semester -->
          <div class="sem2">
            <h3>2nd Sem Notes and Past Papers</h3>
            <div class="btn">
              <button onclick="showNotesOrPastPapers(event)"><a href="#"><span></span>Exams</a></button>
              <button onclick="showNotesOrPastPapers(event)"><a href="#"><span></span>Notes</a></button>
            </div>

            <div class="files-dropdown-past">
              {% for paper in past_papers %}
                {% if paper.year == section.year and paper.sem == 2 %}
                  <div>{{ paper.name }}</div>
                  <a href="{% url 'download_pastpaper' file_id=paper.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>

            <div class="files-dropdown-notes">
              {% for note in notes %}
                {% if note.year == section.year and note.sem == 2 %}
                  <div>{{ note.name }}</div>
                  <a href="{% url 'download_note' file_id=note.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <div class="course-description">
      <h2>COURSE DESCRIPTION</h2>
      <h2>{{ course.course_name }}</h2>
      <p>{{ course.decription|linebreaksbr }}</p>
    </div>
  </div>

  <script>
    // JavaScript function to show a section and hide others
    function showSection(sectionId) {
      // Hide all sections
      var sections = document.querySelectorAll('.section')
      sections.forEach(function (section) {
        section.classList.remove('active')
        section.style.display = 'none' // Ensure sections are hidden
      })
    
      // Show the clicked section
      var sectionToShow = document.getElementById(sectionId)
      if (sectionToShow) {
        sectionToShow.classList.add('active')
        sectionToShow.style.display = 'block' // Ensure only the clicked section is shown
      }
    
      // Prevent scrolling to other sections
      window.scrollTo(0, 0)
    }
    
    // Call showSection with 'homepage' by default to show the homepage content
    showSection('homepage')
    
    // JavaScript function to show notes or past papers
    function showNotesOrPastPapers(event) {
      // Prevent default action if necessary
      event.preventDefault()
    
      // Get the clicked button
      const clickedButton = event.currentTarget
    
      // Select sections
      const notesSection = document.querySelector('.files-dropdown-notes')
      const pastPaperSection = document.querySelector('.files-dropdown-past')
    
      // Check the text of the clicked button
      const buttonText = clickedButton.querySelector('a').textContent.trim()
    
      if (buttonText === 'Exams') {
        // Show past papers section and hide notes section
        pastPaperSection.style.display = 'flex'
        notesSection.style.display = 'none'
      } else if (buttonText === 'Notes') {
        // Show notes section and hide past papers section
        notesSection.style.display = 'flex'
        pastPaperSection.style.display = 'none'
      } else {
        // Hide both sections if neither is clicked
        notesSection.style.display = 'none'
        pastPaperSection.style.display = 'none'
      }
    }
  </script>
{% endblock %}
