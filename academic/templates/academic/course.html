{% extends 'main.html' %}
{% load static %}
{% block content %}
  <div class="course">
    <div class="acad">
      <nav class="butto">
        <!-- Navigation bar with buttons to show different sections -->
        {% for section in sections %}
          <button onclick="showSection('{{ section.id }}')">{{ section.name }}</button>
        {% endfor %}
      </nav>

      {% for section in sections %}
        <div id="{{ section.id }}" class="section {% if section.id == 'homepage' %}active{% endif %}">
          <h2>{{ section.name }} - {{ course.course_name }}</h2>

          <!-- Content for each section -->
          <div class="sem2">
            <h3>1st Sem Notes and Past Papers</h3>
            <div class="btn">
              <button onclick="showNotesPast(event)"><a href="#"><span></span>Exams</a></button>
              <button onclick="showNotesPast(event)"><a href="#"><span></span>Notes</a></button>
            </div>

            <div class="files-dropdown-past">
              {% for paper in past_papers %}
                {% if paper.year == section.year and paper.sem == 1 %}
                  <div>{{ paper.name }}</div>
                  <a href="{% url 'download_pastpaper' file_id=paper.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>

            <div class="files-dropdown-notes">
              {% for note in notes %}
                {% if note.year == section.year and note.sem == 1 %}
                  <div>{{ note.name }}</div>
                  <a href="{% url 'download_note' file_id=note.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>
          </div>

          <!-- Similar content for the 2nd semester -->
          <div class="sem2">
            <h3>2nd Sem Notes and Past Papers</h3>
            <div class="btn">
              <button onclick="showNotesPast(event)"><a href="#"><span></span>Exams</a></button>
              <button onclick="showNotesPast(event)"><a href="#"><span></span>Notes</a></button>
            </div>

            <div class="files-dropdown-past">
              {% for paper in past_papers %}
                {% if paper.year == section.year and paper.sem == 2 %}
                  <div>{{ paper.name }}</div>
                  <a href="{% url 'download_pastpaper' file_id=paper.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>

            <div class="files-dropdown-notes">
              {% for note in notes %}
                {% if note.year == section.year and note.sem == 2 %}
                  <div>{{ note.name }}</div>
                  <a href="{% url 'download_note' file_id=note.id %}">download</a>
                {% endif %}
              {% endfor %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <div class="course-description">
      <h2>COURSE DESCRIPTION</h2>
      <h2>{{ course.course_name }}</h2>
      <p>{{ course.decription|linebreaksbr }}</p>
    </div>
  </div>

  <script>
    // JavaScript function to show a section and hide others
    function showSection(sectionId) {
      // Hide all sections
      var sections = document.querySelectorAll('.section')
      sections.forEach(function (section) {
        section.classList.remove('active')
        section.style.display = 'none' // Ensure sections are hidden
      })
    
      // Show the clicked section
      var sectionToShow = document.getElementById(sectionId)
      if (sectionToShow) {
        sectionToShow.classList.add('active')
        sectionToShow.style.display = 'block' // Ensure only the clicked section is shown
      }
    
      // Prevent scrolling to other sections
      window.scrollTo(0, 0)
    }
    
    // Call showSection with 'homepage' by default to show the homepage content
    showSection('homepage')
    
    // show the past_papers and notes
    {% comment %} function showNotesOrPastPapers(event) {
      event.preventDefault()
    
      // Get the parent container of the clicked button
      const parentContainer = event.target.closest('.sem2')
    
      // Get the text content of the clicked button
      const buttonText = event.target.textContent.trim()
    
      // Get references to the specific past papers and notes sections within the same parent container
      const pastPapersSection = parentContainer.querySelector('.files-dropdown-past')
      const notesSection = parentContainer.querySelector('.files-dropdown-notes')
    
      // Toggle visibility based on the button text
      if (buttonText === 'Exams') {
        pastPapersSection.style.display = 'flex'
        notesSection.style.display = 'none'
      } else if (buttonText === 'Notes') {
        notesSection.style.display = 'flex'
        pastPapersSection.style.display = 'none'
      }
    } {% endcomment %}
    
    // Initialize by hiding all sections (optional)
    {% comment %} document.querySelectorAll('.files-dropdown-past, .files-dropdown-notes').forEach((section) => {
      section.style.display = 'none'
    }) {% endcomment %}

  

    function showNotesPast(event) {
      const buttonText = event.target.textContent.trim();

      const pastPaperSection = document.querySelector(".files-dropdown-past");
      const notesSection = document.querySelector(".files-dropdown-notes");

      if (buttonText === "Exams") {
        pastPaperSection.classList.toggle('show')

        if (notesSection.classList.includes('show')) {
          notesSection.classList.toggle('show');
        }
      } else if (buttonText === "Notes") {
        notesSection.classList.toggle('show');
        if (pastPaperSection.classList.includes('show')) {
          pastPaperSection.classList.toggle('show');
        }
      }
    }
  </script>
{% endblock %}
